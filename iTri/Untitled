require 'net/http'
require 'json'
require 'rb-readline'
require 'byebug'

uri = URI('https://eastus.api.cognitive.microsoft.com/face/v1.0/detect')
uri.query = URI.encode_www_form({
    # Request parameters
    'returnFaceId' => 'true',
    'returnFaceLandmarks' => 'true',
})

request = Net::HTTP::Post.new(uri.request_uri)
# Request headers
request['Content-Type'] = 'application/json'
# Request headers
request['Ocp-Apim-Subscription-Key'] = 'f3463949a9074485b0c360b451e3694c,46e5cd5c72e2404488aadbc30f22601d'
# Request body
request.body = JSON.generate({"url": "data:image/png;base64,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"})

response = Net::HTTP.start(uri.host, uri.port, :use_ssl => uri.scheme == 'https') do |http|
    http.request(request)
end
